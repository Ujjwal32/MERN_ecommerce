{"ast":null,"code":"'use strict';\n\nfunction unwrapExports(x) {\n  return x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;\n}\n\nfunction createCommonjsModule(fn, module) {\n  return module = {\n    exports: {}\n  }, fn(module, module.exports), module.exports;\n}\n\nvar lib = createCommonjsModule(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj;\n  };\n\n  var SkipValidation = exports.SkipValidation = function SkipValidation(message) {\n    this.name = \"SkipValidation\";\n    this.message = message;\n  };\n\n  var validateSingle = exports.validateSingle = function validateSingle(data, validators, multipleErrors, all, key) {\n    var errors = [];\n\n    if (typeof validators === \"function\") {\n      validators = [validators];\n    }\n\n    for (var i = 0; i < validators.length; i++) {\n      try {\n        var error = validators[i](data, all);\n\n        if (typeof error === \"string\") {\n          errors.push(error.replace(\"{value}\", data).replace(\"{key}\", key));\n        }\n      } catch (err) {\n        if (err instanceof SkipValidation) {\n          break;\n        }\n      }\n    }\n\n    if (multipleErrors === true) return errors;\n    if (errors.length > 0) return errors[0];\n  };\n\n  var validate = exports.validate = function validate(data, validators, multipleErrors) {\n    if (!validators) return;\n    var errors = {};\n    var noError = true;\n\n    if ((typeof validators === \"undefined\" ? \"undefined\" : _typeof(validators)) === \"object\" && !validators.length) {\n      for (var prop in validators) {\n        if (validators.hasOwnProperty(prop)) {\n          var error = validateSingle(data[prop], validators[prop], multipleErrors, data, prop);\n\n          if (error !== undefined) {\n            noError = false;\n          }\n\n          errors[prop] = error;\n        }\n      }\n\n      return noError ? undefined : errors;\n    }\n\n    errors = validateSingle(data, validators, multipleErrors);\n    return errors;\n  };\n\n  var required = exports.required = function required(flag, error) {\n    function isNullLike(value) {\n      return value === undefined || value === \"\" || value === null;\n    }\n\n    return function (value) {\n      if (flag && isNullLike(value)) {\n        return error || \"This field is required.\";\n      } else if (!flag && isNullLike(value)) {\n        // skip rest of the validators\n        throw new SkipValidation();\n      }\n    };\n  };\n\n  var isNumber = exports.isNumber = function isNumber(error) {\n    return function (value) {\n      if (typeof value !== \"number\" || isNaN(value)) {\n        return error || \"'{value}' is not a valid number.\";\n      }\n    };\n  };\n\n  var isString = exports.isString = function isString(error) {\n    return function (value) {\n      if (typeof value !== \"string\") {\n        return error || \"'{value}' is not a valid string.\";\n      }\n    };\n  };\n\n  var isFunction = exports.isFunction = function isFunction(error) {\n    return function (value) {\n      if (typeof value !== \"function\") {\n        return error || \"Expected a function.\";\n      }\n    };\n  };\n\n  var isObject = exports.isObject = function isObject(error) {\n    return function (value) {\n      if (value !== Object(value)) {\n        return error || \"Expected an object.\";\n      }\n    };\n  };\n\n  var isArray = exports.isArray = function isArray(error) {\n    return function (value) {\n      if (Object.prototype.toString.call(value) !== \"[object Array]\") {\n        return error || \"Expected an array.\";\n      }\n    };\n  };\n\n  var length = exports.length = function length(_length, error) {\n    return function (value) {\n      var str = value + \"\";\n\n      if (str.length !== _length) {\n        return error || \"It must be \" + _length + \" characters long.\";\n      }\n    };\n  };\n\n  var isEmail = exports.isEmail = function isEmail(error) {\n    return function (value) {\n      var pattern = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\n      if (!pattern.test(value)) {\n        return error || \"Invalid email id.\";\n      }\n    };\n  };\n\n  var equalsTo = exports.equalsTo = function equalsTo(key, error) {\n    return function (value, all) {\n      if (value !== all[key]) {\n        return error || \"'{key}' and '\" + key + \"' do not match.\";\n      }\n    };\n  };\n\n  var minLength = exports.minLength = function minLength(length, error) {\n    return function (value) {\n      var str = value + \"\";\n\n      if (str.length < length) {\n        return error || \"It must be at least \" + length + \" characters long.\";\n      }\n    };\n  };\n\n  var maxLength = exports.maxLength = function maxLength(length, error) {\n    return function (value) {\n      var str = value + \"\";\n\n      if (str.length > length) {\n        return error || \"It must be at most \" + length + \" characters long.\";\n      }\n    };\n  };\n\n  var isBoolean = exports.isBoolean = function isBoolean(error) {\n    return function (value) {\n      if (value !== true && value !== false) {\n        return error || \"Invalid boolean value.\";\n      }\n    };\n  };\n\n  var within = exports.within = function within(list, error) {\n    return function (value) {\n      if (!(value instanceof Array)) {\n        value = [value];\n      }\n\n      var odds = [];\n\n      for (var index = 0; index < value.length; index++) {\n        if (list.indexOf(value[index]) === -1) {\n          odds.push(value[index]);\n        }\n      }\n\n      if (odds.length > 0) {\n        return error || \"[\" + odds + \"] do not fall under the allowed list.\";\n      }\n    };\n  };\n\n  var excludes = exports.excludes = function excludes(list, error) {\n    return function (value) {\n      if (!(value instanceof Array)) {\n        value = [value];\n      }\n\n      var odds = [];\n\n      for (var index = 0; index < value.length; index++) {\n        if (list.indexOf(value[index]) !== -1) {\n          odds.push(value[index]);\n        }\n      }\n\n      if (odds.length > 0) {\n        return error || \"[\" + odds + \"] fall under restricted values.\";\n      }\n    };\n  };\n\n  var pattern = exports.pattern = function pattern(regex, error) {\n    return function (value) {\n      if (!regex.test(value)) {\n        return error || \"'{value}' does not match with the pattern.\";\n      }\n    };\n  };\n});\nunwrapExports(lib);\nvar lib_1 = lib.SkipValidation;\nvar lib_2 = lib.validateSingle;\nvar lib_3 = lib.validate;\nvar lib_4 = lib.required;\nvar lib_5 = lib.isNumber;\nvar lib_6 = lib.isString;\nvar lib_7 = lib.isFunction;\nvar lib_8 = lib.isObject;\nvar lib_9 = lib.isArray;\nvar lib_10 = lib.length;\nvar lib_11 = lib.isEmail;\nvar lib_12 = lib.equalsTo;\nvar lib_13 = lib.minLength;\nvar lib_14 = lib.maxLength;\nvar lib_15 = lib.isBoolean;\nvar lib_16 = lib.within;\nvar lib_17 = lib.excludes;\nvar lib_18 = lib.pattern;\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nvar paymentType = {\n  EBANKING: \"EBANKING\",\n  MOBILE_BANKING: \"MOBILE_BANKING\",\n  CONNECT_IPS: \"CONNECT_IPS\",\n  SCT: \"SCT\",\n  KHALTI: \"KHALTI\"\n};\nvar CDN_HOST = \"https://khalti.s3.ap-south-1.amazonaws.com/KPG/dist/2020.12.22.0.0.0\";\nvar ZHTML_src = CDN_HOST + \"/payment_gateway_widget.html\";\nvar INFINITY_LOADER = CDN_HOST + \"/icons/infinity-loader.svg\";\n\nvar clone = function clone(data) {\n  if (!data) return data;\n  return JSON.parse(JSON.stringify(data));\n};\n\nvar eventHandlerSchema = {\n  onSuccess: [lib_4(true), lib_7()],\n  onError: [lib_4(false), lib_7()],\n  onClose: [lib_4(false), lib_7()]\n};\nvar configSchema = {\n  publicKey: lib_4(true),\n  productUrl: lib_4(true),\n  productIdentity: lib_4(true),\n  productName: lib_4(true),\n  eventHandler: lib_4(true),\n  amount: lib_4(true),\n  merchantData: [lib_4(false), lib_8()],\n  paymentPreference: [lib_4(false), lib_9()]\n};\n\nvar KhaltiCheckout = function () {\n  function KhaltiCheckout(config) {\n    _classCallCheck(this, KhaltiCheckout);\n\n    this._widgetId = \"khalti-widget-\" + Date.now();\n    this._config = config;\n    this._widget = this.attachWidget();\n    this.listenToWidget();\n    this.paymentType = paymentType;\n    this.widgetLoaded = false;\n  }\n\n  _createClass(KhaltiCheckout, [{\n    key: \"listenToWidget\",\n    value: function listenToWidget() {\n      var _this = this;\n\n      window.addEventListener(\"message\", function (e) {\n        if (!e.data.realm) return;\n\n        if (e.data.realm === \"widgetInit\") {\n          _this.widgetInit(e.data.payload);\n        } else if (e.data.realm === 'widgetLoad' && !_this.widgetLoaded) {\n          if (e.data.payload.loaded) {\n            _this.hideLoader();\n\n            _this.widgetInit();\n\n            _this.widgetLoaded = e.data.payload.loaded;\n          }\n        } else if (!e.data.payload || e.data.payload.widget_id !== _this._widgetId) {\n          return;\n        } else {\n          var handler = \"handle_msg_\" + e.data.realm;\n\n          _this[handler](e.data.payload);\n        }\n      }, false);\n    }\n  }, {\n    key: \"msgWidget\",\n    value: function msgWidget(realm, payload) {\n      payload = clone(payload);\n      payload.widgetId = this._widgetId;\n      payload.source = \"checkout_v2.1\";\n\n      this._widget.contentWindow.postMessage({\n        realm: realm,\n        payload: payload\n      }, \"*\");\n    }\n  }, {\n    key: \"handle_msg_widgetInit\",\n    value: function handle_msg_widgetInit() {\n      this.widgetInit();\n    }\n  }, {\n    key: \"widgetInit\",\n    value: function widgetInit(data) {\n      var paymentInfo = clone(this._config);\n      delete paymentInfo.eventHandler;\n      this.msgWidget(\"paymentInfo\", paymentInfo);\n    }\n  }, {\n    key: \"diplayLoader\",\n    value: function diplayLoader() {\n      var loader = window.document.getElementById('loader' + this._widgetId);\n      loader.style.display = 'block';\n    }\n  }, {\n    key: \"hideLoader\",\n    value: function hideLoader() {\n      var loader = window.document.getElementById('loader' + this._widgetId);\n      loader.style.display = 'none';\n    }\n  }, {\n    key: \"validateConfig\",\n    value: function validateConfig() {\n      var errors = lib_3(this._config, configSchema);\n\n      if (errors) {\n        throw new Error(JSON.stringify(errors));\n      } else {\n        var _errors = lib_3(this._config.eventHandler, eventHandlerSchema);\n\n        if (_errors) {\n          throw new Error(JSON.stringify({\n            eventHandler: _errors\n          }));\n        }\n      }\n    }\n  }, {\n    key: \"handle_msg_walletPaymentVerification\",\n    value: function handle_msg_walletPaymentVerification(paymentInfo) {\n      this._config.eventHandler.onSuccess(paymentInfo);\n\n      this.hide();\n    }\n  }, {\n    key: \"handle_msg_widgetError\",\n    value: function handle_msg_widgetError(error) {\n      var errorHandler = this._config.eventHandler.onError;\n      errorHandler && errorHandler(error);\n    }\n  }, {\n    key: \"disableParentScrollbar\",\n    value: function disableParentScrollbar() {\n      this.parentOverflowValue = window.document.body.style.overflowY;\n      window.document.body.style.overflowY = \"hidden\";\n    }\n  }, {\n    key: \"enableParentScrollbar\",\n    value: function enableParentScrollbar() {\n      window.document.body.style.overflowY = this.parentOverflowValue;\n      this.parentOverflowValue = null;\n    }\n  }, {\n    key: \"show\",\n    value: function show(updates) {\n      Object.assign(this._config, updates);\n      this.validateConfig();\n      this.disableParentScrollbar();\n      this._widget.style.display = \"block\";\n\n      if (this.widgetLoaded) {\n        this.widgetInit();\n      } else {\n        this.diplayLoader();\n      }\n    }\n  }, {\n    key: \"handle_msg_hide\",\n    value: function handle_msg_hide() {\n      this.hide();\n      var closeHandler = this._config.eventHandler.onClose;\n      closeHandler && closeHandler();\n    }\n  }, {\n    key: \"hide\",\n    value: function hide() {\n      this.enableParentScrollbar();\n      this._widget.style.display = \"none\";\n    }\n  }, {\n    key: \"attachWidget\",\n    value: function attachWidget() {\n      var widget = window.document.createElement(\"iframe\");\n      widget.setAttribute(\"id\", this._widgetId);\n      widget.style.position = \"fixed\";\n      widget.style.display = \"none\";\n      widget.style.top = \"0\";\n      widget.style.left = \"0\";\n      widget.width = \"100%\";\n      widget.height = window.innerHeight + \"px\";\n      widget.setAttribute(\"src\", ZHTML_src);\n      widget.style.zIndex = 99999;\n      widget.setAttribute(\"frameborder\", 0);\n      widget.setAttribute(\"allowtransparency\", true);\n      var loader = window.document.createElement('div');\n      loader.setAttribute(\"id\", 'loader' + this._widgetId);\n      loader.style.width = '100%';\n      loader.style.height = '100%';\n      loader.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';\n      loader.style.top = '0px';\n      loader.style.left = '0px';\n      loader.style.position = 'absolute';\n      loader.style.display = 'none';\n      loader.innerHTML = \"<img style=\\\"position:relative;left:50%;top:50%;transform:translate(-50%, -50%);z-index: 99999;\\\" src=\" + INFINITY_LOADER + \"></img>\";\n\n      if (!window.document.body.contains(loader)) {\n        window.document.body.appendChild(loader);\n      }\n\n      window.document.body.appendChild(widget);\n      return widget;\n    }\n  }]);\n\n  return KhaltiCheckout;\n}();\n\nmodule.exports = KhaltiCheckout;","map":{"version":3,"sources":["E:/Study Material/Projects/Fullstack/e-commerce/client/node_modules/khalti-checkout-web/dist/khalti-checkout.cjs.js"],"names":["unwrapExports","x","__esModule","Object","prototype","hasOwnProperty","call","createCommonjsModule","fn","module","exports","lib","defineProperty","value","_typeof","Symbol","iterator","obj","constructor","SkipValidation","message","name","validateSingle","data","validators","multipleErrors","all","key","errors","i","length","error","push","replace","err","validate","noError","prop","undefined","required","flag","isNullLike","isNumber","isNaN","isString","isFunction","isObject","isArray","toString","_length","str","isEmail","pattern","test","equalsTo","minLength","maxLength","isBoolean","within","list","Array","odds","index","indexOf","excludes","regex","lib_1","lib_2","lib_3","lib_4","lib_5","lib_6","lib_7","lib_8","lib_9","lib_10","lib_11","lib_12","lib_13","lib_14","lib_15","lib_16","lib_17","lib_18","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","Constructor","protoProps","staticProps","_classCallCheck","instance","TypeError","paymentType","EBANKING","MOBILE_BANKING","CONNECT_IPS","SCT","KHALTI","CDN_HOST","ZHTML_src","INFINITY_LOADER","clone","JSON","parse","stringify","eventHandlerSchema","onSuccess","onError","onClose","configSchema","publicKey","productUrl","productIdentity","productName","eventHandler","amount","merchantData","paymentPreference","KhaltiCheckout","config","_widgetId","Date","now","_config","_widget","attachWidget","listenToWidget","widgetLoaded","_this","window","addEventListener","e","realm","widgetInit","payload","loaded","hideLoader","widget_id","handler","msgWidget","widgetId","source","contentWindow","postMessage","handle_msg_widgetInit","paymentInfo","diplayLoader","loader","document","getElementById","style","display","validateConfig","Error","_errors","handle_msg_walletPaymentVerification","hide","handle_msg_widgetError","errorHandler","disableParentScrollbar","parentOverflowValue","body","overflowY","enableParentScrollbar","show","updates","assign","handle_msg_hide","closeHandler","widget","createElement","setAttribute","position","top","left","width","height","innerHeight","zIndex","backgroundColor","innerHTML","contains","appendChild"],"mappings":"AAAA;;AAEA,SAASA,aAAT,CAAwBC,CAAxB,EAA2B;AAC1B,SAAOA,CAAC,IAAIA,CAAC,CAACC,UAAP,IAAqBC,MAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCL,CAArC,EAAwC,SAAxC,CAArB,GAA0EA,CAAC,CAAC,SAAD,CAA3E,GAAyFA,CAAhG;AACA;;AAED,SAASM,oBAAT,CAA8BC,EAA9B,EAAkCC,MAAlC,EAA0C;AACzC,SAAOA,MAAM,GAAG;AAAEC,IAAAA,OAAO,EAAE;AAAX,GAAT,EAA0BF,EAAE,CAACC,MAAD,EAASA,MAAM,CAACC,OAAhB,CAA5B,EAAsDD,MAAM,CAACC,OAApE;AACA;;AAED,IAAIC,GAAG,GAAGJ,oBAAoB,CAAC,UAAUE,MAAV,EAAkBC,OAAlB,EAA2B;AAE1DP,EAAAA,MAAM,CAACS,cAAP,CAAsBF,OAAtB,EAA+B,YAA/B,EAA6C;AAC5CG,IAAAA,KAAK,EAAE;AADqC,GAA7C;;AAIA,MAAIC,OAAO,GAAG,OAAOC,MAAP,KAAkB,UAAlB,IAAgC,OAAOA,MAAM,CAACC,QAAd,KAA2B,QAA3D,GAAsE,UAAUC,GAAV,EAAe;AAAE,WAAO,OAAOA,GAAd;AAAoB,GAA3G,GAA8G,UAAUA,GAAV,EAAe;AAAE,WAAOA,GAAG,IAAI,OAAOF,MAAP,KAAkB,UAAzB,IAAuCE,GAAG,CAACC,WAAJ,KAAoBH,MAA3D,GAAoE,QAApE,GAA+E,OAAOE,GAA7F;AAAmG,GAAhP;;AAEA,MAAIE,cAAc,GAAGT,OAAO,CAACS,cAAR,GAAyB,SAASA,cAAT,CAAwBC,OAAxB,EAAiC;AAC9E,SAAKC,IAAL,GAAY,gBAAZ;AACA,SAAKD,OAAL,GAAeA,OAAf;AACA,GAHD;;AAKA,MAAIE,cAAc,GAAGZ,OAAO,CAACY,cAAR,GAAyB,SAASA,cAAT,CAAwBC,IAAxB,EAA8BC,UAA9B,EAA0CC,cAA1C,EAA0DC,GAA1D,EAA+DC,GAA/D,EAAoE;AACjH,QAAIC,MAAM,GAAG,EAAb;;AAEA,QAAI,OAAOJ,UAAP,KAAsB,UAA1B,EAAsC;AACrCA,MAAAA,UAAU,GAAG,CAACA,UAAD,CAAb;AACA;;AAED,SAAK,IAAIK,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,UAAU,CAACM,MAA/B,EAAuCD,CAAC,EAAxC,EAA4C;AAC3C,UAAI;AACH,YAAIE,KAAK,GAAGP,UAAU,CAACK,CAAD,CAAV,CAAcN,IAAd,EAAoBG,GAApB,CAAZ;;AACA,YAAI,OAAOK,KAAP,KAAiB,QAArB,EAA+B;AAC9BH,UAAAA,MAAM,CAACI,IAAP,CAAYD,KAAK,CAACE,OAAN,CAAc,SAAd,EAAyBV,IAAzB,EAA+BU,OAA/B,CAAuC,OAAvC,EAAgDN,GAAhD,CAAZ;AACA;AACD,OALD,CAKE,OAAOO,GAAP,EAAY;AACb,YAAIA,GAAG,YAAYf,cAAnB,EAAmC;AAClC;AACA;AACD;AACD;;AAED,QAAIM,cAAc,KAAK,IAAvB,EAA6B,OAAOG,MAAP;AAE7B,QAAIA,MAAM,CAACE,MAAP,GAAgB,CAApB,EAAuB,OAAOF,MAAM,CAAC,CAAD,CAAb;AACvB,GAvBD;;AAyBA,MAAIO,QAAQ,GAAGzB,OAAO,CAACyB,QAAR,GAAmB,SAASA,QAAT,CAAkBZ,IAAlB,EAAwBC,UAAxB,EAAoCC,cAApC,EAAoD;AACrF,QAAI,CAACD,UAAL,EAAiB;AAEjB,QAAII,MAAM,GAAG,EAAb;AACA,QAAIQ,OAAO,GAAG,IAAd;;AAEA,QAAI,CAAC,OAAOZ,UAAP,KAAsB,WAAtB,GAAoC,WAApC,GAAkDV,OAAO,CAACU,UAAD,CAA1D,MAA4E,QAA5E,IAAwF,CAACA,UAAU,CAACM,MAAxG,EAAgH;AAC/G,WAAK,IAAIO,IAAT,IAAiBb,UAAjB,EAA6B;AAC5B,YAAIA,UAAU,CAACnB,cAAX,CAA0BgC,IAA1B,CAAJ,EAAqC;AACpC,cAAIN,KAAK,GAAGT,cAAc,CAACC,IAAI,CAACc,IAAD,CAAL,EAAab,UAAU,CAACa,IAAD,CAAvB,EAA+BZ,cAA/B,EAA+CF,IAA/C,EAAqDc,IAArD,CAA1B;;AAEA,cAAIN,KAAK,KAAKO,SAAd,EAAyB;AACxBF,YAAAA,OAAO,GAAG,KAAV;AACA;;AAEDR,UAAAA,MAAM,CAACS,IAAD,CAAN,GAAeN,KAAf;AACA;AACD;;AAED,aAAOK,OAAO,GAAGE,SAAH,GAAeV,MAA7B;AACA;;AAEDA,IAAAA,MAAM,GAAGN,cAAc,CAACC,IAAD,EAAOC,UAAP,EAAmBC,cAAnB,CAAvB;AACA,WAAOG,MAAP;AACA,GAxBD;;AA0BA,MAAIW,QAAQ,GAAG7B,OAAO,CAAC6B,QAAR,GAAmB,SAASA,QAAT,CAAkBC,IAAlB,EAAwBT,KAAxB,EAA+B;AAChE,aAASU,UAAT,CAAoB5B,KAApB,EAA2B;AAC1B,aAAOA,KAAK,KAAKyB,SAAV,IAAuBzB,KAAK,KAAK,EAAjC,IAAuCA,KAAK,KAAK,IAAxD;AACA;;AAED,WAAO,UAAUA,KAAV,EAAiB;AACvB,UAAI2B,IAAI,IAAIC,UAAU,CAAC5B,KAAD,CAAtB,EAA+B;AAC9B,eAAOkB,KAAK,IAAI,yBAAhB;AACA,OAFD,MAEO,IAAI,CAACS,IAAD,IAASC,UAAU,CAAC5B,KAAD,CAAvB,EAAgC;AACtC;AACA,cAAM,IAAIM,cAAJ,EAAN;AACA;AACD,KAPD;AAQA,GAbD;;AAeA,MAAIuB,QAAQ,GAAGhC,OAAO,CAACgC,QAAR,GAAmB,SAASA,QAAT,CAAkBX,KAAlB,EAAyB;AAC1D,WAAO,UAAUlB,KAAV,EAAiB;AACvB,UAAI,OAAOA,KAAP,KAAiB,QAAjB,IAA6B8B,KAAK,CAAC9B,KAAD,CAAtC,EAA+C;AAC9C,eAAOkB,KAAK,IAAI,kCAAhB;AACA;AACD,KAJD;AAKA,GAND;;AAQA,MAAIa,QAAQ,GAAGlC,OAAO,CAACkC,QAAR,GAAmB,SAASA,QAAT,CAAkBb,KAAlB,EAAyB;AAC1D,WAAO,UAAUlB,KAAV,EAAiB;AACvB,UAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC9B,eAAOkB,KAAK,IAAI,kCAAhB;AACA;AACD,KAJD;AAKA,GAND;;AAQA,MAAIc,UAAU,GAAGnC,OAAO,CAACmC,UAAR,GAAqB,SAASA,UAAT,CAAoBd,KAApB,EAA2B;AAChE,WAAO,UAAUlB,KAAV,EAAiB;AACvB,UAAI,OAAOA,KAAP,KAAiB,UAArB,EAAiC;AAChC,eAAOkB,KAAK,IAAI,sBAAhB;AACA;AACD,KAJD;AAKA,GAND;;AAQA,MAAIe,QAAQ,GAAGpC,OAAO,CAACoC,QAAR,GAAmB,SAASA,QAAT,CAAkBf,KAAlB,EAAyB;AAC1D,WAAO,UAAUlB,KAAV,EAAiB;AACvB,UAAIA,KAAK,KAAKV,MAAM,CAACU,KAAD,CAApB,EAA6B;AAC5B,eAAOkB,KAAK,IAAI,qBAAhB;AACA;AACD,KAJD;AAKA,GAND;;AAQA,MAAIgB,OAAO,GAAGrC,OAAO,CAACqC,OAAR,GAAkB,SAASA,OAAT,CAAiBhB,KAAjB,EAAwB;AACvD,WAAO,UAAUlB,KAAV,EAAiB;AACvB,UAAIV,MAAM,CAACC,SAAP,CAAiB4C,QAAjB,CAA0B1C,IAA1B,CAA+BO,KAA/B,MAA0C,gBAA9C,EAAgE;AAC/D,eAAOkB,KAAK,IAAI,oBAAhB;AACA;AACD,KAJD;AAKA,GAND;;AAQA,MAAID,MAAM,GAAGpB,OAAO,CAACoB,MAAR,GAAiB,SAASA,MAAT,CAAgBmB,OAAhB,EAAyBlB,KAAzB,EAAgC;AAC7D,WAAO,UAAUlB,KAAV,EAAiB;AACvB,UAAIqC,GAAG,GAAGrC,KAAK,GAAG,EAAlB;;AACA,UAAIqC,GAAG,CAACpB,MAAJ,KAAemB,OAAnB,EAA4B;AAC3B,eAAOlB,KAAK,IAAI,gBAAgBkB,OAAhB,GAA0B,mBAA1C;AACA;AACD,KALD;AAMA,GAPD;;AASA,MAAIE,OAAO,GAAGzC,OAAO,CAACyC,OAAR,GAAkB,SAASA,OAAT,CAAiBpB,KAAjB,EAAwB;AACvD,WAAO,UAAUlB,KAAV,EAAiB;AACvB,UAAIuC,OAAO,GAAG,wJAAd;;AACA,UAAI,CAACA,OAAO,CAACC,IAAR,CAAaxC,KAAb,CAAL,EAA0B;AACzB,eAAOkB,KAAK,IAAI,mBAAhB;AACA;AACD,KALD;AAMA,GAPD;;AASA,MAAIuB,QAAQ,GAAG5C,OAAO,CAAC4C,QAAR,GAAmB,SAASA,QAAT,CAAkB3B,GAAlB,EAAuBI,KAAvB,EAA8B;AAC/D,WAAO,UAAUlB,KAAV,EAAiBa,GAAjB,EAAsB;AAC5B,UAAIb,KAAK,KAAKa,GAAG,CAACC,GAAD,CAAjB,EAAwB;AACvB,eAAOI,KAAK,IAAI,kBAAkBJ,GAAlB,GAAwB,iBAAxC;AACA;AACD,KAJD;AAKA,GAND;;AAQA,MAAI4B,SAAS,GAAG7C,OAAO,CAAC6C,SAAR,GAAoB,SAASA,SAAT,CAAmBzB,MAAnB,EAA2BC,KAA3B,EAAkC;AACrE,WAAO,UAAUlB,KAAV,EAAiB;AACvB,UAAIqC,GAAG,GAAGrC,KAAK,GAAG,EAAlB;;AACA,UAAIqC,GAAG,CAACpB,MAAJ,GAAaA,MAAjB,EAAyB;AACxB,eAAOC,KAAK,IAAI,yBAAyBD,MAAzB,GAAkC,mBAAlD;AACA;AACD,KALD;AAMA,GAPD;;AASA,MAAI0B,SAAS,GAAG9C,OAAO,CAAC8C,SAAR,GAAoB,SAASA,SAAT,CAAmB1B,MAAnB,EAA2BC,KAA3B,EAAkC;AACrE,WAAO,UAAUlB,KAAV,EAAiB;AACvB,UAAIqC,GAAG,GAAGrC,KAAK,GAAG,EAAlB;;AACA,UAAIqC,GAAG,CAACpB,MAAJ,GAAaA,MAAjB,EAAyB;AACxB,eAAOC,KAAK,IAAI,wBAAwBD,MAAxB,GAAiC,mBAAjD;AACA;AACD,KALD;AAMA,GAPD;;AASA,MAAI2B,SAAS,GAAG/C,OAAO,CAAC+C,SAAR,GAAoB,SAASA,SAAT,CAAmB1B,KAAnB,EAA0B;AAC7D,WAAO,UAAUlB,KAAV,EAAiB;AACvB,UAAIA,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAK,KAAhC,EAAuC;AACtC,eAAOkB,KAAK,IAAI,wBAAhB;AACA;AACD,KAJD;AAKA,GAND;;AAQA,MAAI2B,MAAM,GAAGhD,OAAO,CAACgD,MAAR,GAAiB,SAASA,MAAT,CAAgBC,IAAhB,EAAsB5B,KAAtB,EAA6B;AAC1D,WAAO,UAAUlB,KAAV,EAAiB;AACvB,UAAI,EAAEA,KAAK,YAAY+C,KAAnB,CAAJ,EAA+B;AAC9B/C,QAAAA,KAAK,GAAG,CAACA,KAAD,CAAR;AACA;;AAED,UAAIgD,IAAI,GAAG,EAAX;;AAEA,WAAK,IAAIC,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGjD,KAAK,CAACiB,MAAlC,EAA0CgC,KAAK,EAA/C,EAAmD;AAClD,YAAIH,IAAI,CAACI,OAAL,CAAalD,KAAK,CAACiD,KAAD,CAAlB,MAA+B,CAAC,CAApC,EAAuC;AACtCD,UAAAA,IAAI,CAAC7B,IAAL,CAAUnB,KAAK,CAACiD,KAAD,CAAf;AACA;AACD;;AAED,UAAID,IAAI,CAAC/B,MAAL,GAAc,CAAlB,EAAqB;AACpB,eAAOC,KAAK,IAAI,MAAM8B,IAAN,GAAa,uCAA7B;AACA;AACD,KAhBD;AAiBA,GAlBD;;AAoBA,MAAIG,QAAQ,GAAGtD,OAAO,CAACsD,QAAR,GAAmB,SAASA,QAAT,CAAkBL,IAAlB,EAAwB5B,KAAxB,EAA+B;AAChE,WAAO,UAAUlB,KAAV,EAAiB;AACvB,UAAI,EAAEA,KAAK,YAAY+C,KAAnB,CAAJ,EAA+B;AAC9B/C,QAAAA,KAAK,GAAG,CAACA,KAAD,CAAR;AACA;;AAED,UAAIgD,IAAI,GAAG,EAAX;;AAEA,WAAK,IAAIC,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGjD,KAAK,CAACiB,MAAlC,EAA0CgC,KAAK,EAA/C,EAAmD;AAClD,YAAIH,IAAI,CAACI,OAAL,CAAalD,KAAK,CAACiD,KAAD,CAAlB,MAA+B,CAAC,CAApC,EAAuC;AACtCD,UAAAA,IAAI,CAAC7B,IAAL,CAAUnB,KAAK,CAACiD,KAAD,CAAf;AACA;AACD;;AAED,UAAID,IAAI,CAAC/B,MAAL,GAAc,CAAlB,EAAqB;AACpB,eAAOC,KAAK,IAAI,MAAM8B,IAAN,GAAa,iCAA7B;AACA;AACD,KAhBD;AAiBA,GAlBD;;AAoBA,MAAIT,OAAO,GAAG1C,OAAO,CAAC0C,OAAR,GAAkB,SAASA,OAAT,CAAiBa,KAAjB,EAAwBlC,KAAxB,EAA+B;AAC9D,WAAO,UAAUlB,KAAV,EAAiB;AACvB,UAAI,CAACoD,KAAK,CAACZ,IAAN,CAAWxC,KAAX,CAAL,EAAwB;AACvB,eAAOkB,KAAK,IAAI,4CAAhB;AACA;AACD,KAJD;AAKA,GAND;AAOC,CA1N6B,CAA9B;AA4NA/B,aAAa,CAACW,GAAD,CAAb;AACA,IAAIuD,KAAK,GAAGvD,GAAG,CAACQ,cAAhB;AACA,IAAIgD,KAAK,GAAGxD,GAAG,CAACW,cAAhB;AACA,IAAI8C,KAAK,GAAGzD,GAAG,CAACwB,QAAhB;AACA,IAAIkC,KAAK,GAAG1D,GAAG,CAAC4B,QAAhB;AACA,IAAI+B,KAAK,GAAG3D,GAAG,CAAC+B,QAAhB;AACA,IAAI6B,KAAK,GAAG5D,GAAG,CAACiC,QAAhB;AACA,IAAI4B,KAAK,GAAG7D,GAAG,CAACkC,UAAhB;AACA,IAAI4B,KAAK,GAAG9D,GAAG,CAACmC,QAAhB;AACA,IAAI4B,KAAK,GAAG/D,GAAG,CAACoC,OAAhB;AACA,IAAI4B,MAAM,GAAGhE,GAAG,CAACmB,MAAjB;AACA,IAAI8C,MAAM,GAAGjE,GAAG,CAACwC,OAAjB;AACA,IAAI0B,MAAM,GAAGlE,GAAG,CAAC2C,QAAjB;AACA,IAAIwB,MAAM,GAAGnE,GAAG,CAAC4C,SAAjB;AACA,IAAIwB,MAAM,GAAGpE,GAAG,CAAC6C,SAAjB;AACA,IAAIwB,MAAM,GAAGrE,GAAG,CAAC8C,SAAjB;AACA,IAAIwB,MAAM,GAAGtE,GAAG,CAAC+C,MAAjB;AACA,IAAIwB,MAAM,GAAGvE,GAAG,CAACqD,QAAjB;AACA,IAAImB,MAAM,GAAGxE,GAAG,CAACyC,OAAjB;;AAEA,IAAIgC,YAAY,GAAG,YAAY;AAAE,WAASC,gBAAT,CAA0BC,MAA1B,EAAkCC,KAAlC,EAAyC;AAAE,SAAK,IAAI1D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0D,KAAK,CAACzD,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;AAAE,UAAI2D,UAAU,GAAGD,KAAK,CAAC1D,CAAD,CAAtB;AAA2B2D,MAAAA,UAAU,CAACC,UAAX,GAAwBD,UAAU,CAACC,UAAX,IAAyB,KAAjD;AAAwDD,MAAAA,UAAU,CAACE,YAAX,GAA0B,IAA1B;AAAgC,UAAI,WAAWF,UAAf,EAA2BA,UAAU,CAACG,QAAX,GAAsB,IAAtB;AAA4BxF,MAAAA,MAAM,CAACS,cAAP,CAAsB0E,MAAtB,EAA8BE,UAAU,CAAC7D,GAAzC,EAA8C6D,UAA9C;AAA4D;AAAE;;AAAC,SAAO,UAAUI,WAAV,EAAuBC,UAAvB,EAAmCC,WAAnC,EAAgD;AAAE,QAAID,UAAJ,EAAgBR,gBAAgB,CAACO,WAAW,CAACxF,SAAb,EAAwByF,UAAxB,CAAhB;AAAqD,QAAIC,WAAJ,EAAiBT,gBAAgB,CAACO,WAAD,EAAcE,WAAd,CAAhB;AAA4C,WAAOF,WAAP;AAAqB,GAAhN;AAAmN,CAA9hB,EAAnB;;AAEA,SAASG,eAAT,CAAyBC,QAAzB,EAAmCJ,WAAnC,EAAgD;AAAE,MAAI,EAAEI,QAAQ,YAAYJ,WAAtB,CAAJ,EAAwC;AAAE,UAAM,IAAIK,SAAJ,CAAc,mCAAd,CAAN;AAA2D;AAAE;;AAEzJ,IAAIC,WAAW,GAAG;AAChBC,EAAAA,QAAQ,EAAE,UADM;AAEhBC,EAAAA,cAAc,EAAE,gBAFA;AAGhBC,EAAAA,WAAW,EAAE,aAHG;AAIhBC,EAAAA,GAAG,EAAE,KAJW;AAKhBC,EAAAA,MAAM,EAAE;AALQ,CAAlB;AAQA,IAAIC,QAAQ,GAAG,sEAAf;AAEA,IAAIC,SAAS,GAAGD,QAAQ,GAAG,8BAA3B;AACA,IAAIE,eAAe,GAAGF,QAAQ,GAAG,4BAAjC;;AAEA,IAAIG,KAAK,GAAG,SAASA,KAAT,CAAepF,IAAf,EAAqB;AAC/B,MAAI,CAACA,IAAL,EAAW,OAAOA,IAAP;AACX,SAAOqF,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAevF,IAAf,CAAX,CAAP;AACD,CAHD;;AAKA,IAAIwF,kBAAkB,GAAG;AACvBC,EAAAA,SAAS,EAAE,CAAC3C,KAAK,CAAC,IAAD,CAAN,EAAcG,KAAK,EAAnB,CADY;AAEvByC,EAAAA,OAAO,EAAE,CAAC5C,KAAK,CAAC,KAAD,CAAN,EAAeG,KAAK,EAApB,CAFc;AAGvB0C,EAAAA,OAAO,EAAE,CAAC7C,KAAK,CAAC,KAAD,CAAN,EAAeG,KAAK,EAApB;AAHc,CAAzB;AAMA,IAAI2C,YAAY,GAAG;AACjBC,EAAAA,SAAS,EAAE/C,KAAK,CAAC,IAAD,CADC;AAEjBgD,EAAAA,UAAU,EAAEhD,KAAK,CAAC,IAAD,CAFA;AAGjBiD,EAAAA,eAAe,EAAEjD,KAAK,CAAC,IAAD,CAHL;AAIjBkD,EAAAA,WAAW,EAAElD,KAAK,CAAC,IAAD,CAJD;AAKjBmD,EAAAA,YAAY,EAAEnD,KAAK,CAAC,IAAD,CALF;AAMjBoD,EAAAA,MAAM,EAAEpD,KAAK,CAAC,IAAD,CANI;AAOjBqD,EAAAA,YAAY,EAAE,CAACrD,KAAK,CAAC,KAAD,CAAN,EAAeI,KAAK,EAApB,CAPG;AAQjBkD,EAAAA,iBAAiB,EAAE,CAACtD,KAAK,CAAC,KAAD,CAAN,EAAeK,KAAK,EAApB;AARF,CAAnB;;AAWA,IAAIkD,cAAc,GAAG,YAAY;AAC/B,WAASA,cAAT,CAAwBC,MAAxB,EAAgC;AAC9B9B,IAAAA,eAAe,CAAC,IAAD,EAAO6B,cAAP,CAAf;;AAEA,SAAKE,SAAL,GAAiB,mBAAmBC,IAAI,CAACC,GAAL,EAApC;AACA,SAAKC,OAAL,GAAeJ,MAAf;AACA,SAAKK,OAAL,GAAe,KAAKC,YAAL,EAAf;AACA,SAAKC,cAAL;AACA,SAAKlC,WAAL,GAAmBA,WAAnB;AACA,SAAKmC,YAAL,GAAoB,KAApB;AACD;;AAEDjD,EAAAA,YAAY,CAACwC,cAAD,EAAiB,CAAC;AAC5BjG,IAAAA,GAAG,EAAE,gBADuB;AAE5Bd,IAAAA,KAAK,EAAE,SAASuH,cAAT,GAA0B;AAC/B,UAAIE,KAAK,GAAG,IAAZ;;AAEAC,MAAAA,MAAM,CAACC,gBAAP,CAAwB,SAAxB,EAAmC,UAAUC,CAAV,EAAa;AAC9C,YAAI,CAACA,CAAC,CAAClH,IAAF,CAAOmH,KAAZ,EAAmB;;AACnB,YAAID,CAAC,CAAClH,IAAF,CAAOmH,KAAP,KAAiB,YAArB,EAAmC;AACjCJ,UAAAA,KAAK,CAACK,UAAN,CAAiBF,CAAC,CAAClH,IAAF,CAAOqH,OAAxB;AACD,SAFD,MAEO,IAAIH,CAAC,CAAClH,IAAF,CAAOmH,KAAP,KAAiB,YAAjB,IAAiC,CAACJ,KAAK,CAACD,YAA5C,EAA0D;AAC/D,cAAII,CAAC,CAAClH,IAAF,CAAOqH,OAAP,CAAeC,MAAnB,EAA2B;AACzBP,YAAAA,KAAK,CAACQ,UAAN;;AACAR,YAAAA,KAAK,CAACK,UAAN;;AACAL,YAAAA,KAAK,CAACD,YAAN,GAAqBI,CAAC,CAAClH,IAAF,CAAOqH,OAAP,CAAeC,MAApC;AACD;AACF,SANM,MAMA,IAAI,CAACJ,CAAC,CAAClH,IAAF,CAAOqH,OAAR,IAAmBH,CAAC,CAAClH,IAAF,CAAOqH,OAAP,CAAeG,SAAf,KAA6BT,KAAK,CAACR,SAA1D,EAAqE;AAC1E;AACD,SAFM,MAEA;AACL,cAAIkB,OAAO,GAAG,gBAAgBP,CAAC,CAAClH,IAAF,CAAOmH,KAArC;;AACAJ,UAAAA,KAAK,CAACU,OAAD,CAAL,CAAeP,CAAC,CAAClH,IAAF,CAAOqH,OAAtB;AACD;AACF,OAhBD,EAgBG,KAhBH;AAiBD;AAtB2B,GAAD,EAuB1B;AACDjH,IAAAA,GAAG,EAAE,WADJ;AAEDd,IAAAA,KAAK,EAAE,SAASoI,SAAT,CAAmBP,KAAnB,EAA0BE,OAA1B,EAAmC;AACxCA,MAAAA,OAAO,GAAGjC,KAAK,CAACiC,OAAD,CAAf;AACAA,MAAAA,OAAO,CAACM,QAAR,GAAmB,KAAKpB,SAAxB;AACAc,MAAAA,OAAO,CAACO,MAAR,GAAiB,eAAjB;;AACA,WAAKjB,OAAL,CAAakB,aAAb,CAA2BC,WAA3B,CAAuC;AAAEX,QAAAA,KAAK,EAAEA,KAAT;AAAgBE,QAAAA,OAAO,EAAEA;AAAzB,OAAvC,EAA2E,GAA3E;AACD;AAPA,GAvB0B,EA+B1B;AACDjH,IAAAA,GAAG,EAAE,uBADJ;AAEDd,IAAAA,KAAK,EAAE,SAASyI,qBAAT,GAAiC;AACtC,WAAKX,UAAL;AACD;AAJA,GA/B0B,EAoC1B;AACDhH,IAAAA,GAAG,EAAE,YADJ;AAEDd,IAAAA,KAAK,EAAE,SAAS8H,UAAT,CAAoBpH,IAApB,EAA0B;AAC/B,UAAIgI,WAAW,GAAG5C,KAAK,CAAC,KAAKsB,OAAN,CAAvB;AACA,aAAOsB,WAAW,CAAC/B,YAAnB;AACA,WAAKyB,SAAL,CAAe,aAAf,EAA8BM,WAA9B;AACD;AANA,GApC0B,EA2C1B;AACD5H,IAAAA,GAAG,EAAE,cADJ;AAEDd,IAAAA,KAAK,EAAE,SAAS2I,YAAT,GAAwB;AAC7B,UAAIC,MAAM,GAAGlB,MAAM,CAACmB,QAAP,CAAgBC,cAAhB,CAA+B,WAAW,KAAK7B,SAA/C,CAAb;AACA2B,MAAAA,MAAM,CAACG,KAAP,CAAaC,OAAb,GAAuB,OAAvB;AACD;AALA,GA3C0B,EAiD1B;AACDlI,IAAAA,GAAG,EAAE,YADJ;AAEDd,IAAAA,KAAK,EAAE,SAASiI,UAAT,GAAsB;AAC3B,UAAIW,MAAM,GAAGlB,MAAM,CAACmB,QAAP,CAAgBC,cAAhB,CAA+B,WAAW,KAAK7B,SAA/C,CAAb;AACA2B,MAAAA,MAAM,CAACG,KAAP,CAAaC,OAAb,GAAuB,MAAvB;AACD;AALA,GAjD0B,EAuD1B;AACDlI,IAAAA,GAAG,EAAE,gBADJ;AAEDd,IAAAA,KAAK,EAAE,SAASiJ,cAAT,GAA0B;AAC/B,UAAIlI,MAAM,GAAGwC,KAAK,CAAC,KAAK6D,OAAN,EAAed,YAAf,CAAlB;;AACA,UAAIvF,MAAJ,EAAY;AACV,cAAM,IAAImI,KAAJ,CAAUnD,IAAI,CAACE,SAAL,CAAelF,MAAf,CAAV,CAAN;AACD,OAFD,MAEO;AACL,YAAIoI,OAAO,GAAG5F,KAAK,CAAC,KAAK6D,OAAL,CAAaT,YAAd,EAA4BT,kBAA5B,CAAnB;;AACA,YAAIiD,OAAJ,EAAa;AACX,gBAAM,IAAID,KAAJ,CAAUnD,IAAI,CAACE,SAAL,CAAe;AAAEU,YAAAA,YAAY,EAAEwC;AAAhB,WAAf,CAAV,CAAN;AACD;AACF;AACF;AAZA,GAvD0B,EAoE1B;AACDrI,IAAAA,GAAG,EAAE,sCADJ;AAEDd,IAAAA,KAAK,EAAE,SAASoJ,oCAAT,CAA8CV,WAA9C,EAA2D;AAChE,WAAKtB,OAAL,CAAaT,YAAb,CAA0BR,SAA1B,CAAoCuC,WAApC;;AACA,WAAKW,IAAL;AACD;AALA,GApE0B,EA0E1B;AACDvI,IAAAA,GAAG,EAAE,wBADJ;AAEDd,IAAAA,KAAK,EAAE,SAASsJ,sBAAT,CAAgCpI,KAAhC,EAAuC;AAC5C,UAAIqI,YAAY,GAAG,KAAKnC,OAAL,CAAaT,YAAb,CAA0BP,OAA7C;AACAmD,MAAAA,YAAY,IAAIA,YAAY,CAACrI,KAAD,CAA5B;AACD;AALA,GA1E0B,EAgF1B;AACDJ,IAAAA,GAAG,EAAE,wBADJ;AAEDd,IAAAA,KAAK,EAAE,SAASwJ,sBAAT,GAAkC;AACvC,WAAKC,mBAAL,GAA2B/B,MAAM,CAACmB,QAAP,CAAgBa,IAAhB,CAAqBX,KAArB,CAA2BY,SAAtD;AACAjC,MAAAA,MAAM,CAACmB,QAAP,CAAgBa,IAAhB,CAAqBX,KAArB,CAA2BY,SAA3B,GAAuC,QAAvC;AACD;AALA,GAhF0B,EAsF1B;AACD7I,IAAAA,GAAG,EAAE,uBADJ;AAEDd,IAAAA,KAAK,EAAE,SAAS4J,qBAAT,GAAiC;AACtClC,MAAAA,MAAM,CAACmB,QAAP,CAAgBa,IAAhB,CAAqBX,KAArB,CAA2BY,SAA3B,GAAuC,KAAKF,mBAA5C;AACA,WAAKA,mBAAL,GAA2B,IAA3B;AACD;AALA,GAtF0B,EA4F1B;AACD3I,IAAAA,GAAG,EAAE,MADJ;AAEDd,IAAAA,KAAK,EAAE,SAAS6J,IAAT,CAAcC,OAAd,EAAuB;AAE5BxK,MAAAA,MAAM,CAACyK,MAAP,CAAc,KAAK3C,OAAnB,EAA4B0C,OAA5B;AACA,WAAKb,cAAL;AACA,WAAKO,sBAAL;AACA,WAAKnC,OAAL,CAAa0B,KAAb,CAAmBC,OAAnB,GAA6B,OAA7B;;AACA,UAAI,KAAKxB,YAAT,EAAuB;AACrB,aAAKM,UAAL;AACD,OAFD,MAEO;AACL,aAAKa,YAAL;AACD;AACF;AAbA,GA5F0B,EA0G1B;AACD7H,IAAAA,GAAG,EAAE,iBADJ;AAEDd,IAAAA,KAAK,EAAE,SAASgK,eAAT,GAA2B;AAChC,WAAKX,IAAL;AACA,UAAIY,YAAY,GAAG,KAAK7C,OAAL,CAAaT,YAAb,CAA0BN,OAA7C;AACA4D,MAAAA,YAAY,IAAIA,YAAY,EAA5B;AACD;AANA,GA1G0B,EAiH1B;AACDnJ,IAAAA,GAAG,EAAE,MADJ;AAEDd,IAAAA,KAAK,EAAE,SAASqJ,IAAT,GAAgB;AACrB,WAAKO,qBAAL;AACA,WAAKvC,OAAL,CAAa0B,KAAb,CAAmBC,OAAnB,GAA6B,MAA7B;AACD;AALA,GAjH0B,EAuH1B;AACDlI,IAAAA,GAAG,EAAE,cADJ;AAEDd,IAAAA,KAAK,EAAE,SAASsH,YAAT,GAAwB;AAC7B,UAAI4C,MAAM,GAAGxC,MAAM,CAACmB,QAAP,CAAgBsB,aAAhB,CAA8B,QAA9B,CAAb;AACAD,MAAAA,MAAM,CAACE,YAAP,CAAoB,IAApB,EAA0B,KAAKnD,SAA/B;AACAiD,MAAAA,MAAM,CAACnB,KAAP,CAAasB,QAAb,GAAwB,OAAxB;AACAH,MAAAA,MAAM,CAACnB,KAAP,CAAaC,OAAb,GAAuB,MAAvB;AACAkB,MAAAA,MAAM,CAACnB,KAAP,CAAauB,GAAb,GAAmB,GAAnB;AACAJ,MAAAA,MAAM,CAACnB,KAAP,CAAawB,IAAb,GAAoB,GAApB;AACAL,MAAAA,MAAM,CAACM,KAAP,GAAe,MAAf;AACAN,MAAAA,MAAM,CAACO,MAAP,GAAgB/C,MAAM,CAACgD,WAAP,GAAqB,IAArC;AACAR,MAAAA,MAAM,CAACE,YAAP,CAAoB,KAApB,EAA2BxE,SAA3B;AACAsE,MAAAA,MAAM,CAACnB,KAAP,CAAa4B,MAAb,GAAsB,KAAtB;AACAT,MAAAA,MAAM,CAACE,YAAP,CAAoB,aAApB,EAAmC,CAAnC;AACAF,MAAAA,MAAM,CAACE,YAAP,CAAoB,mBAApB,EAAyC,IAAzC;AAEA,UAAIxB,MAAM,GAAGlB,MAAM,CAACmB,QAAP,CAAgBsB,aAAhB,CAA8B,KAA9B,CAAb;AACAvB,MAAAA,MAAM,CAACwB,YAAP,CAAoB,IAApB,EAA0B,WAAW,KAAKnD,SAA1C;AAEA2B,MAAAA,MAAM,CAACG,KAAP,CAAayB,KAAb,GAAqB,MAArB;AACA5B,MAAAA,MAAM,CAACG,KAAP,CAAa0B,MAAb,GAAsB,MAAtB;AACA7B,MAAAA,MAAM,CAACG,KAAP,CAAa6B,eAAb,GAA+B,oBAA/B;AACAhC,MAAAA,MAAM,CAACG,KAAP,CAAauB,GAAb,GAAmB,KAAnB;AACA1B,MAAAA,MAAM,CAACG,KAAP,CAAawB,IAAb,GAAoB,KAApB;AACA3B,MAAAA,MAAM,CAACG,KAAP,CAAasB,QAAb,GAAwB,UAAxB;AACAzB,MAAAA,MAAM,CAACG,KAAP,CAAaC,OAAb,GAAuB,MAAvB;AACAJ,MAAAA,MAAM,CAACiC,SAAP,GAAmB,2GAA2GhF,eAA3G,GAA6H,SAAhJ;;AAEA,UAAI,CAAC6B,MAAM,CAACmB,QAAP,CAAgBa,IAAhB,CAAqBoB,QAArB,CAA8BlC,MAA9B,CAAL,EAA4C;AAC1ClB,QAAAA,MAAM,CAACmB,QAAP,CAAgBa,IAAhB,CAAqBqB,WAArB,CAAiCnC,MAAjC;AACD;;AAEDlB,MAAAA,MAAM,CAACmB,QAAP,CAAgBa,IAAhB,CAAqBqB,WAArB,CAAiCb,MAAjC;AAEA,aAAOA,MAAP;AACD;AAnCA,GAvH0B,CAAjB,CAAZ;;AA6JA,SAAOnD,cAAP;AACD,CA1KoB,EAArB;;AA4KAnH,MAAM,CAACC,OAAP,GAAiBkH,cAAjB","sourcesContent":["'use strict';\n\nfunction unwrapExports (x) {\n\treturn x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;\n}\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar lib = createCommonjsModule(function (module, exports) {\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nvar SkipValidation = exports.SkipValidation = function SkipValidation(message) {\n\tthis.name = \"SkipValidation\";\n\tthis.message = message;\n};\n\nvar validateSingle = exports.validateSingle = function validateSingle(data, validators, multipleErrors, all, key) {\n\tvar errors = [];\n\n\tif (typeof validators === \"function\") {\n\t\tvalidators = [validators];\n\t}\n\n\tfor (var i = 0; i < validators.length; i++) {\n\t\ttry {\n\t\t\tvar error = validators[i](data, all);\n\t\t\tif (typeof error === \"string\") {\n\t\t\t\terrors.push(error.replace(\"{value}\", data).replace(\"{key}\", key));\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tif (err instanceof SkipValidation) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (multipleErrors === true) return errors;\n\n\tif (errors.length > 0) return errors[0];\n};\n\nvar validate = exports.validate = function validate(data, validators, multipleErrors) {\n\tif (!validators) return;\n\n\tvar errors = {};\n\tvar noError = true;\n\n\tif ((typeof validators === \"undefined\" ? \"undefined\" : _typeof(validators)) === \"object\" && !validators.length) {\n\t\tfor (var prop in validators) {\n\t\t\tif (validators.hasOwnProperty(prop)) {\n\t\t\t\tvar error = validateSingle(data[prop], validators[prop], multipleErrors, data, prop);\n\n\t\t\t\tif (error !== undefined) {\n\t\t\t\t\tnoError = false;\n\t\t\t\t}\n\n\t\t\t\terrors[prop] = error;\n\t\t\t}\n\t\t}\n\n\t\treturn noError ? undefined : errors;\n\t}\n\n\terrors = validateSingle(data, validators, multipleErrors);\n\treturn errors;\n};\n\nvar required = exports.required = function required(flag, error) {\n\tfunction isNullLike(value) {\n\t\treturn value === undefined || value === \"\" || value === null;\n\t}\n\n\treturn function (value) {\n\t\tif (flag && isNullLike(value)) {\n\t\t\treturn error || \"This field is required.\";\n\t\t} else if (!flag && isNullLike(value)) {\n\t\t\t// skip rest of the validators\n\t\t\tthrow new SkipValidation();\n\t\t}\n\t};\n};\n\nvar isNumber = exports.isNumber = function isNumber(error) {\n\treturn function (value) {\n\t\tif (typeof value !== \"number\" || isNaN(value)) {\n\t\t\treturn error || \"'{value}' is not a valid number.\";\n\t\t}\n\t};\n};\n\nvar isString = exports.isString = function isString(error) {\n\treturn function (value) {\n\t\tif (typeof value !== \"string\") {\n\t\t\treturn error || \"'{value}' is not a valid string.\";\n\t\t}\n\t};\n};\n\nvar isFunction = exports.isFunction = function isFunction(error) {\n\treturn function (value) {\n\t\tif (typeof value !== \"function\") {\n\t\t\treturn error || \"Expected a function.\";\n\t\t}\n\t};\n};\n\nvar isObject = exports.isObject = function isObject(error) {\n\treturn function (value) {\n\t\tif (value !== Object(value)) {\n\t\t\treturn error || \"Expected an object.\";\n\t\t}\n\t};\n};\n\nvar isArray = exports.isArray = function isArray(error) {\n\treturn function (value) {\n\t\tif (Object.prototype.toString.call(value) !== \"[object Array]\") {\n\t\t\treturn error || \"Expected an array.\";\n\t\t}\n\t};\n};\n\nvar length = exports.length = function length(_length, error) {\n\treturn function (value) {\n\t\tvar str = value + \"\";\n\t\tif (str.length !== _length) {\n\t\t\treturn error || \"It must be \" + _length + \" characters long.\";\n\t\t}\n\t};\n};\n\nvar isEmail = exports.isEmail = function isEmail(error) {\n\treturn function (value) {\n\t\tvar pattern = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\t\tif (!pattern.test(value)) {\n\t\t\treturn error || \"Invalid email id.\";\n\t\t}\n\t};\n};\n\nvar equalsTo = exports.equalsTo = function equalsTo(key, error) {\n\treturn function (value, all) {\n\t\tif (value !== all[key]) {\n\t\t\treturn error || \"'{key}' and '\" + key + \"' do not match.\";\n\t\t}\n\t};\n};\n\nvar minLength = exports.minLength = function minLength(length, error) {\n\treturn function (value) {\n\t\tvar str = value + \"\";\n\t\tif (str.length < length) {\n\t\t\treturn error || \"It must be at least \" + length + \" characters long.\";\n\t\t}\n\t};\n};\n\nvar maxLength = exports.maxLength = function maxLength(length, error) {\n\treturn function (value) {\n\t\tvar str = value + \"\";\n\t\tif (str.length > length) {\n\t\t\treturn error || \"It must be at most \" + length + \" characters long.\";\n\t\t}\n\t};\n};\n\nvar isBoolean = exports.isBoolean = function isBoolean(error) {\n\treturn function (value) {\n\t\tif (value !== true && value !== false) {\n\t\t\treturn error || \"Invalid boolean value.\";\n\t\t}\n\t};\n};\n\nvar within = exports.within = function within(list, error) {\n\treturn function (value) {\n\t\tif (!(value instanceof Array)) {\n\t\t\tvalue = [value];\n\t\t}\n\n\t\tvar odds = [];\n\n\t\tfor (var index = 0; index < value.length; index++) {\n\t\t\tif (list.indexOf(value[index]) === -1) {\n\t\t\t\todds.push(value[index]);\n\t\t\t}\n\t\t}\n\n\t\tif (odds.length > 0) {\n\t\t\treturn error || \"[\" + odds + \"] do not fall under the allowed list.\";\n\t\t}\n\t};\n};\n\nvar excludes = exports.excludes = function excludes(list, error) {\n\treturn function (value) {\n\t\tif (!(value instanceof Array)) {\n\t\t\tvalue = [value];\n\t\t}\n\n\t\tvar odds = [];\n\n\t\tfor (var index = 0; index < value.length; index++) {\n\t\t\tif (list.indexOf(value[index]) !== -1) {\n\t\t\t\todds.push(value[index]);\n\t\t\t}\n\t\t}\n\n\t\tif (odds.length > 0) {\n\t\t\treturn error || \"[\" + odds + \"] fall under restricted values.\";\n\t\t}\n\t};\n};\n\nvar pattern = exports.pattern = function pattern(regex, error) {\n\treturn function (value) {\n\t\tif (!regex.test(value)) {\n\t\t\treturn error || \"'{value}' does not match with the pattern.\";\n\t\t}\n\t};\n};\n});\n\nunwrapExports(lib);\nvar lib_1 = lib.SkipValidation;\nvar lib_2 = lib.validateSingle;\nvar lib_3 = lib.validate;\nvar lib_4 = lib.required;\nvar lib_5 = lib.isNumber;\nvar lib_6 = lib.isString;\nvar lib_7 = lib.isFunction;\nvar lib_8 = lib.isObject;\nvar lib_9 = lib.isArray;\nvar lib_10 = lib.length;\nvar lib_11 = lib.isEmail;\nvar lib_12 = lib.equalsTo;\nvar lib_13 = lib.minLength;\nvar lib_14 = lib.maxLength;\nvar lib_15 = lib.isBoolean;\nvar lib_16 = lib.within;\nvar lib_17 = lib.excludes;\nvar lib_18 = lib.pattern;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar paymentType = {\n  EBANKING: \"EBANKING\",\n  MOBILE_BANKING: \"MOBILE_BANKING\",\n  CONNECT_IPS: \"CONNECT_IPS\",\n  SCT: \"SCT\",\n  KHALTI: \"KHALTI\"\n};\n\nvar CDN_HOST = \"https://khalti.s3.ap-south-1.amazonaws.com/KPG/dist/2020.12.22.0.0.0\";\n\nvar ZHTML_src = CDN_HOST + \"/payment_gateway_widget.html\";\nvar INFINITY_LOADER = CDN_HOST + \"/icons/infinity-loader.svg\";\n\nvar clone = function clone(data) {\n  if (!data) return data;\n  return JSON.parse(JSON.stringify(data));\n};\n\nvar eventHandlerSchema = {\n  onSuccess: [lib_4(true), lib_7()],\n  onError: [lib_4(false), lib_7()],\n  onClose: [lib_4(false), lib_7()]\n};\n\nvar configSchema = {\n  publicKey: lib_4(true),\n  productUrl: lib_4(true),\n  productIdentity: lib_4(true),\n  productName: lib_4(true),\n  eventHandler: lib_4(true),\n  amount: lib_4(true),\n  merchantData: [lib_4(false), lib_8()],\n  paymentPreference: [lib_4(false), lib_9()]\n};\n\nvar KhaltiCheckout = function () {\n  function KhaltiCheckout(config) {\n    _classCallCheck(this, KhaltiCheckout);\n\n    this._widgetId = \"khalti-widget-\" + Date.now();\n    this._config = config;\n    this._widget = this.attachWidget();\n    this.listenToWidget();\n    this.paymentType = paymentType;\n    this.widgetLoaded = false;\n  }\n\n  _createClass(KhaltiCheckout, [{\n    key: \"listenToWidget\",\n    value: function listenToWidget() {\n      var _this = this;\n\n      window.addEventListener(\"message\", function (e) {\n        if (!e.data.realm) return;\n        if (e.data.realm === \"widgetInit\") {\n          _this.widgetInit(e.data.payload);\n        } else if (e.data.realm === 'widgetLoad' && !_this.widgetLoaded) {\n          if (e.data.payload.loaded) {\n            _this.hideLoader();\n            _this.widgetInit();\n            _this.widgetLoaded = e.data.payload.loaded;\n          }\n        } else if (!e.data.payload || e.data.payload.widget_id !== _this._widgetId) {\n          return;\n        } else {\n          var handler = \"handle_msg_\" + e.data.realm;\n          _this[handler](e.data.payload);\n        }\n      }, false);\n    }\n  }, {\n    key: \"msgWidget\",\n    value: function msgWidget(realm, payload) {\n      payload = clone(payload);\n      payload.widgetId = this._widgetId;\n      payload.source = \"checkout_v2.1\";\n      this._widget.contentWindow.postMessage({ realm: realm, payload: payload }, \"*\");\n    }\n  }, {\n    key: \"handle_msg_widgetInit\",\n    value: function handle_msg_widgetInit() {\n      this.widgetInit();\n    }\n  }, {\n    key: \"widgetInit\",\n    value: function widgetInit(data) {\n      var paymentInfo = clone(this._config);\n      delete paymentInfo.eventHandler;\n      this.msgWidget(\"paymentInfo\", paymentInfo);\n    }\n  }, {\n    key: \"diplayLoader\",\n    value: function diplayLoader() {\n      var loader = window.document.getElementById('loader' + this._widgetId);\n      loader.style.display = 'block';\n    }\n  }, {\n    key: \"hideLoader\",\n    value: function hideLoader() {\n      var loader = window.document.getElementById('loader' + this._widgetId);\n      loader.style.display = 'none';\n    }\n  }, {\n    key: \"validateConfig\",\n    value: function validateConfig() {\n      var errors = lib_3(this._config, configSchema);\n      if (errors) {\n        throw new Error(JSON.stringify(errors));\n      } else {\n        var _errors = lib_3(this._config.eventHandler, eventHandlerSchema);\n        if (_errors) {\n          throw new Error(JSON.stringify({ eventHandler: _errors }));\n        }\n      }\n    }\n  }, {\n    key: \"handle_msg_walletPaymentVerification\",\n    value: function handle_msg_walletPaymentVerification(paymentInfo) {\n      this._config.eventHandler.onSuccess(paymentInfo);\n      this.hide();\n    }\n  }, {\n    key: \"handle_msg_widgetError\",\n    value: function handle_msg_widgetError(error) {\n      var errorHandler = this._config.eventHandler.onError;\n      errorHandler && errorHandler(error);\n    }\n  }, {\n    key: \"disableParentScrollbar\",\n    value: function disableParentScrollbar() {\n      this.parentOverflowValue = window.document.body.style.overflowY;\n      window.document.body.style.overflowY = \"hidden\";\n    }\n  }, {\n    key: \"enableParentScrollbar\",\n    value: function enableParentScrollbar() {\n      window.document.body.style.overflowY = this.parentOverflowValue;\n      this.parentOverflowValue = null;\n    }\n  }, {\n    key: \"show\",\n    value: function show(updates) {\n\n      Object.assign(this._config, updates);\n      this.validateConfig();\n      this.disableParentScrollbar();\n      this._widget.style.display = \"block\";\n      if (this.widgetLoaded) {\n        this.widgetInit();\n      } else {\n        this.diplayLoader();\n      }\n    }\n  }, {\n    key: \"handle_msg_hide\",\n    value: function handle_msg_hide() {\n      this.hide();\n      var closeHandler = this._config.eventHandler.onClose;\n      closeHandler && closeHandler();\n    }\n  }, {\n    key: \"hide\",\n    value: function hide() {\n      this.enableParentScrollbar();\n      this._widget.style.display = \"none\";\n    }\n  }, {\n    key: \"attachWidget\",\n    value: function attachWidget() {\n      var widget = window.document.createElement(\"iframe\");\n      widget.setAttribute(\"id\", this._widgetId);\n      widget.style.position = \"fixed\";\n      widget.style.display = \"none\";\n      widget.style.top = \"0\";\n      widget.style.left = \"0\";\n      widget.width = \"100%\";\n      widget.height = window.innerHeight + \"px\";\n      widget.setAttribute(\"src\", ZHTML_src);\n      widget.style.zIndex = 99999;\n      widget.setAttribute(\"frameborder\", 0);\n      widget.setAttribute(\"allowtransparency\", true);\n\n      var loader = window.document.createElement('div');\n      loader.setAttribute(\"id\", 'loader' + this._widgetId);\n\n      loader.style.width = '100%';\n      loader.style.height = '100%';\n      loader.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';\n      loader.style.top = '0px';\n      loader.style.left = '0px';\n      loader.style.position = 'absolute';\n      loader.style.display = 'none';\n      loader.innerHTML = \"<img style=\\\"position:relative;left:50%;top:50%;transform:translate(-50%, -50%);z-index: 99999;\\\" src=\" + INFINITY_LOADER + \"></img>\";\n\n      if (!window.document.body.contains(loader)) {\n        window.document.body.appendChild(loader);\n      }\n\n      window.document.body.appendChild(widget);\n\n      return widget;\n    }\n  }]);\n\n  return KhaltiCheckout;\n}();\n\nmodule.exports = KhaltiCheckout;\n"]},"metadata":{},"sourceType":"script"}