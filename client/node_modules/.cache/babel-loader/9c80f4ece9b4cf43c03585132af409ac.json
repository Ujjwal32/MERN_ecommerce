{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nexport const fetchProducts = createAsyncThunk('products/fetchProducts', async () => {\n  const products = await axios.get('/products?page=1&limit=5').then(res => {\n    return res.data.result;\n  });\n  const category = await axios.get('/category').then(res => {\n    return res.data.result;\n  });\n  return {\n    products,\n    category\n  };\n});\nexport const postProducts = createAsyncThunk('products/postProducts', async data => {\n  var _sessionStorage$getIt;\n\n  const token = JSON.parse((_sessionStorage$getIt = sessionStorage.getItem('user-e-commerce')) === null || _sessionStorage$getIt === void 0 ? void 0 : _sessionStorage$getIt.token);\n  const products = await axios.post('/products', data, {\n    headers: {\n      \"x-auth\": token,\n      \"Content-Type\": \"application/json\"\n    }\n  }).then(res => {\n    var _res$data;\n\n    if (((_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.msg) === 'Successfully added!') {\n      window.location.href = '/admin/products';\n    }\n  }).catch(err => {\n    console.log(err);\n  });\n  return products;\n});\nexport const addCategory = createAsyncThunk('category/added', async (name, {\n  rejectWithValue\n}) => {\n  const session = JSON.parse(sessionStorage.getItem('user-e-commerce'));\n  const userToken = session && session.token;\n  const category = await axios.post('/category', {\n    name\n  }, {\n    headers: {\n      \"x-auth\": userToken,\n      \"Content-Type\": \"application/json\"\n    }\n  }).then(res => {\n    var _res$data2;\n\n    if (((_res$data2 = res.data) === null || _res$data2 === void 0 ? void 0 : _res$data2.msg) === 'Category added!') {\n      window.location.href = '/admin/category';\n    }\n  }).catch(err => {\n    console.log(err);\n    return rejectWithValue([], err);\n  });\n  return category;\n});\nconst initialState = {\n  status: '',\n  products: [],\n  category: []\n};\nconst productSlice = createSlice({\n  name: \"product\",\n  initialState,\n  reducer: {},\n  extraReducers: {\n    [fetchProducts.pending]: (state, action) => {\n      state.status = 'loading';\n    },\n    [fetchProducts.fulfilled]: (state, action) => {\n      state.status = 'success';\n      state.products = state.products.concat(action.payload.products);\n      state.category = state.category.concat(action.payload.category);\n    },\n    [fetchProducts.rejected]: (state, action) => {\n      state.status = 'failed';\n      console.log(action.payload);\n    },\n    [postProducts.fulfilled]: (state, action) => {\n      state.status = 'success';\n      state.products = state.products.concat(action.payload);\n    },\n    [postProducts.rejected]: (state, action) => {\n      state.status = 'failed';\n      console.log(action.payload);\n    },\n    [addCategory.pending]: (state, action) => {\n      state.status = 'loading';\n    },\n    [addCategory.fulfilled]: (state, action) => {\n      state.status = 'success';\n      state.category = state.category.concat(action.payload.category);\n    },\n    [addCategory.rejected]: (state, {\n      payload,\n      error\n    }) => {\n      state.status = 'failed';\n      console.log(error);\n    }\n  }\n});\nexport default productSlice.reducer;","map":{"version":3,"sources":["E:/Study Material/Projects/Fullstack/e-commerce/client/src/features/productSlice.js"],"names":["createAsyncThunk","createSlice","axios","fetchProducts","products","get","then","res","data","result","category","postProducts","token","JSON","parse","sessionStorage","getItem","post","headers","msg","window","location","href","catch","err","console","log","addCategory","name","rejectWithValue","session","userToken","initialState","status","productSlice","reducer","extraReducers","pending","state","action","fulfilled","concat","payload","rejected","error"],"mappings":"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","sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\r\nimport axios from \"axios\";\r\n\r\n\r\nexport const fetchProducts = createAsyncThunk('products/fetchProducts', async ()=> {\r\n    const products = await axios.get('/products?page=1&limit=5').then( res => {\r\n        return res.data.result\r\n    })\r\n    const category = await axios.get('/category').then( res => {\r\n        return res.data.result\r\n    })\r\n    return {products,category}\r\n})\r\n\r\nexport const postProducts = createAsyncThunk('products/postProducts', async (data)=> {\r\n    const token = JSON.parse(sessionStorage.getItem('user-e-commerce')?.token)\r\n    const products = await axios.post('/products',data,{ headers: {\r\n        \"x-auth\": token,\r\n        \"Content-Type\": \"application/json\"\r\n      }}).then(res => {\r\n        if(res.data?.msg === 'Successfully added!'){\r\n          window.location.href = '/admin/products'\r\n        }\r\n      }).catch(err => {\r\n        console.log(err)\r\n      })\r\n    return products\r\n})\r\n\r\nexport const addCategory = createAsyncThunk('category/added', async (name,{ rejectWithValue }) => {\r\n    const session = JSON.parse(sessionStorage.getItem('user-e-commerce'))\r\n    const userToken = session && session.token\r\n    const category = await axios.post('/category',{name},{ headers: {\r\n        \"x-auth\": userToken,\r\n        \"Content-Type\": \"application/json\"\r\n      }}).then(res => {\r\n        if(res.data?.msg === 'Category added!'){\r\n          window.location.href = '/admin/category'\r\n        }\r\n      }).catch(err => {\r\n        console.log(err)\r\n        return rejectWithValue([],err)\r\n      })\r\n    return category\r\n})\r\n\r\nconst initialState = {\r\n    status: '',\r\n    products: [],\r\n    category: []\r\n}\r\n\r\nconst productSlice = createSlice({\r\n    name: \"product\",\r\n    initialState,\r\n    reducer: {\r\n\r\n    },\r\n    extraReducers: {\r\n        [fetchProducts.pending]: (state,action) => {\r\n            state.status = 'loading'\r\n        },\r\n        [fetchProducts.fulfilled]: (state,action) => {\r\n            state.status = 'success'\r\n            state.products = state.products.concat(action.payload.products)\r\n            state.category = state.category.concat(action.payload.category)\r\n        },\r\n        [fetchProducts.rejected]: (state,action) => {\r\n            state.status = 'failed'\r\n            console.log(action.payload)\r\n        },\r\n        [postProducts.fulfilled]: (state,action) => {\r\n            state.status = 'success'\r\n            state.products = state.products.concat(action.payload)\r\n        },\r\n        [postProducts.rejected]: (state,action) => {\r\n            state.status = 'failed'\r\n            console.log(action.payload)\r\n        },\r\n        [addCategory.pending]: (state,action) => {\r\n            state.status = 'loading'\r\n        },\r\n        [addCategory.fulfilled]: (state,action) => {\r\n            state.status = 'success'\r\n            state.category = state.category.concat(action.payload.category)\r\n        },\r\n        [addCategory.rejected]: (state,{payload,error}) => {\r\n            state.status = 'failed'\r\n            console.log(error)\r\n        },\r\n    }\r\n})\r\n\r\n\r\nexport default productSlice.reducer"]},"metadata":{},"sourceType":"module"}